"use strict";
var __cov_075HeH56i5fNv8ZxFDWa0A = (Function('return this'))();
if (!__cov_075HeH56i5fNv8ZxFDWa0A.__coverage__) { __cov_075HeH56i5fNv8ZxFDWa0A.__coverage__ = {}; }
__cov_075HeH56i5fNv8ZxFDWa0A = __cov_075HeH56i5fNv8ZxFDWa0A.__coverage__;
if (!(__cov_075HeH56i5fNv8ZxFDWa0A['app/config/stripe-events.js'])) {
   __cov_075HeH56i5fNv8ZxFDWa0A['app/config/stripe-events.js'] = {"path":"app/config/stripe-events.js","s":{"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0},"b":{"1":[0,0],"2":[0,0,0]},"f":{"1":0,"2":0,"3":0,"4":0,"5":0},"fnMap":{"1":{"name":"(anonymous_1)","line":63,"loc":{"start":{"line":63,"column":34},"end":{"line":63,"column":54}}},"2":{"name":"(anonymous_2)","line":70,"loc":{"start":{"line":70,"column":43},"end":{"line":70,"column":69}}},"3":{"name":"(anonymous_3)","line":98,"loc":{"start":{"line":98,"column":47},"end":{"line":98,"column":73}}},"4":{"name":"(anonymous_4)","line":106,"loc":{"start":{"line":106,"column":33},"end":{"line":106,"column":59}}},"5":{"name":"(anonymous_5)","line":151,"loc":{"start":{"line":151,"column":17},"end":{"line":151,"column":43}}}},"statementMap":{"1":{"start":{"line":3,"column":0},"end":{"line":9,"column":21}},"2":{"start":{"line":11,"column":0},"end":{"line":60,"column":2}},"3":{"start":{"line":62,"column":0},"end":{"line":67,"column":1}},"4":{"start":{"line":63,"column":5},"end":{"line":66,"column":6}},"5":{"start":{"line":64,"column":10},"end":{"line":64,"column":66}},"6":{"start":{"line":65,"column":10},"end":{"line":65,"column":32}},"7":{"start":{"line":70,"column":0},"end":{"line":93,"column":2}},"8":{"start":{"line":76,"column":5},"end":{"line":76,"column":46}},"9":{"start":{"line":77,"column":5},"end":{"line":85,"column":7}},"10":{"start":{"line":86,"column":6},"end":{"line":86,"column":38}},"11":{"start":{"line":98,"column":0},"end":{"line":103,"column":2}},"12":{"start":{"line":100,"column":5},"end":{"line":100,"column":34}},"13":{"start":{"line":106,"column":0},"end":{"line":111,"column":2}},"14":{"start":{"line":108,"column":5},"end":{"line":108,"column":34}},"15":{"start":{"line":151,"column":0},"end":{"line":157,"column":1}},"16":{"start":{"line":152,"column":5},"end":{"line":156,"column":6}},"17":{"start":{"line":153,"column":10},"end":{"line":153,"column":60}},"18":{"start":{"line":155,"column":10},"end":{"line":155,"column":59}}},"branchMap":{"1":{"line":152,"type":"if","locations":[{"start":{"line":152,"column":5},"end":{"line":152,"column":5}},{"start":{"line":152,"column":5},"end":{"line":152,"column":5}}]},"2":{"line":152,"type":"binary-expr","locations":[{"start":{"line":152,"column":9},"end":{"line":152,"column":24}},{"start":{"line":152,"column":28},"end":{"line":152,"column":48}},{"start":{"line":152,"column":52},"end":{"line":152,"column":85}}]}}};
}
__cov_075HeH56i5fNv8ZxFDWa0A = __cov_075HeH56i5fNv8ZxFDWa0A['app/config/stripe-events.js'];
__cov_075HeH56i5fNv8ZxFDWa0A.s['1']++;var User=require('../models/user'),stripeWebhooksConsumer=require('../controllers/stripe/stripe-webhooks-consumer'),utils=require('../utils').findUser,publisher=require('../amqp/publisher'),findUser=utils.findUser,updateUser=utils.updateUser,knownEvents={};__cov_075HeH56i5fNv8ZxFDWa0A.s['2']++;var eventNames=['account.updated','account.application.deauthorized','application_fee.created','application_fee.refunded','balance.available','charge.succeeded','charge.failed','charge.refunded','charge.captured','charge.updated','charge.dispute.created','charge.dispute.updated','charge.dispute.closed','customer.created','customer.updated','customer.deleted','customer.card.created','customer.card.updated','customer.card.deleted','customer.subscription.created','customer.subscription.updated','customer.subscription.trial_will_end','customer.discount.created','customer.discount.updated','customer.discount.deleted','invoice.created','invoice.updated','invoice.payment_succeeded','invoice.payment_failed','invoiceitem.created','invoiceitem.updated','invoiceitem.deleted','plan.created','plan.updated','plan.deleted','coupon.created','coupon.deleted','recipient.created','recipient.updated','recipient.deleted','transfer.created','transfer.updated','transfer.paid','transfer.failed','ping'];__cov_075HeH56i5fNv8ZxFDWa0A.s['3']++;for(var i=0,leng=eventNames.length;i<leng;i++){__cov_075HeH56i5fNv8ZxFDWa0A.s['4']++;knownEvents[eventNames[i]]=function(req,res){__cov_075HeH56i5fNv8ZxFDWa0A.f['1']++;__cov_075HeH56i5fNv8ZxFDWa0A.s['5']++;console.log(req.stripeEvent.type+': event processed');__cov_075HeH56i5fNv8ZxFDWa0A.s['6']++;res.status(200).end();};}__cov_075HeH56i5fNv8ZxFDWa0A.s['7']++;knownEvents['invoice.payment_succeeded']=function(req,res,next){__cov_075HeH56i5fNv8ZxFDWa0A.f['2']++;__cov_075HeH56i5fNv8ZxFDWa0A.s['8']++;var subObj=req.stripeEvent.data.object;__cov_075HeH56i5fNv8ZxFDWa0A.s['9']++;var message={subscriptionId:subObj.subscription,customerId:subObj.customer,type:'invoice.payment_succeeded',data:{periodStart:subObj.period_start,periodEnd:subObj.period_end}};__cov_075HeH56i5fNv8ZxFDWa0A.s['10']++;stripeWebhooksConsumer(message);};__cov_075HeH56i5fNv8ZxFDWa0A.s['11']++;knownEvents['customer.subscription.updated']=function(req,res,next){__cov_075HeH56i5fNv8ZxFDWa0A.f['3']++;__cov_075HeH56i5fNv8ZxFDWa0A.s['12']++;return res.status(200).end();};__cov_075HeH56i5fNv8ZxFDWa0A.s['13']++;knownEvents['invoice.created']=function(req,res,next){__cov_075HeH56i5fNv8ZxFDWa0A.f['4']++;__cov_075HeH56i5fNv8ZxFDWa0A.s['14']++;return res.status(200).end();};__cov_075HeH56i5fNv8ZxFDWa0A.s['15']++;module.exports=function(req,res,next){__cov_075HeH56i5fNv8ZxFDWa0A.f['5']++;__cov_075HeH56i5fNv8ZxFDWa0A.s['16']++;if((__cov_075HeH56i5fNv8ZxFDWa0A.b['2'][0]++,req.stripeEvent)&&(__cov_075HeH56i5fNv8ZxFDWa0A.b['2'][1]++,req.stripeEvent.type)&&(__cov_075HeH56i5fNv8ZxFDWa0A.b['2'][2]++,knownEvents[req.stripeEvent.type])){__cov_075HeH56i5fNv8ZxFDWa0A.b['1'][0]++;__cov_075HeH56i5fNv8ZxFDWa0A.s['17']++;knownEvents[req.stripeEvent.type](req,res,next);}else{__cov_075HeH56i5fNv8ZxFDWa0A.b['1'][1]++;__cov_075HeH56i5fNv8ZxFDWa0A.s['18']++;return next(new Error('Stripe Event not found'));}};
