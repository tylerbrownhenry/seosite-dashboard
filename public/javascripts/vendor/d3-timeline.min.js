!function(){d3.timeline=function(){function X(a){function $(a,b){return v.left+(a.starting_time-s)*L}function _(a,b){return v.left+(a.starting_time-s)*L+5}function aa(){if(l||i.attr("height"))l?i.attr("height",l):l=i.attr("height");else{if(!A)throw"height of the timeline is not set";l=Y.height+Y.top-h.top,d3.select(a[0][0]).attr("height",l)}}function ba(){if(k||h.width){if(!k||!h.width)try{k=i.attr("width")}catch(a){console.log(a)}}else try{if(k=i.attr("width"),!k)throw"width of the timeline is not set. As of Firefox 27, timeline().with(x) needs to be explicitly set in order to render"}catch(a){console.log(a)}}function ca(b,c){a.append("svg:line").attr("x1",b).attr("y1",c.marginTop).attr("x2",b).attr("y2",l-c.marginBottom).style("stroke",c.color).style("stroke-width",c.width)}var g=a.append("g"),h=a[0][0].getBoundingClientRect(),i=d3.select(a[0][0]),t={},z=1,C=0,H=0;ba(),y&&g.each(function(a,b){a.forEach(function(a,b){a.times.forEach(function(a,c){0===b&&0===c?(originTime=a.starting_time,a.starting_time=0,a.ending_time=a.ending_time-originTime):(a.starting_time=a.starting_time-originTime,a.ending_time=a.ending_time-originTime)})})}),(w||0===u||0===s)&&(g.each(function(a,b){a.forEach(function(a,b){w&&Object.keys(t).indexOf(b)==-1&&(t[b]=z,z++),a.times.forEach(function(a,b){0===s&&(a.starting_time<C||0===C&&y===!1)&&(C=a.starting_time),0===u&&a.ending_time>H&&(H=a.ending_time)})})}),0===u&&(u=H),0===s&&(s=C));var L=1/(u-s)*(k-v.left-v.right),M=d3.time.scale().domain([s,u]).range([v.left,k-v.right]),N=d3.svg.axis().scale(M).orient(j).tickFormat(o.format).ticks(o.numTicks||o.tickTime,o.tickInterval).tickSize(o.tickSize);g.each(function(f,h){P=f,f.forEach(function(f,h){function o(a,b){return w?v.top+(A+B)*t[h]:v.top}function s(a,b){return w?v.top+(A+B)*t[h]+.75*A:v.top+.75*A}var i=f.times,j="undefined"!=typeof f.label;if("undefined"!=typeof f.id&&console.warn("d3Timeline Warning: Ids per dataset is deprecated in favor of a 'class' key. Ids are now per data element."),n&&V(t,h,g,i,f),g.selectAll("svg").data(i).enter().append(function(a,b){return document.createElementNS(d3.ns.prefix.svg,"display"in a?a.display:r)}).attr("x",$).attr("y",o).attr("width",function(a,b){return(a.ending_time-a.starting_time)*L}).attr("cy",function(a,b){return o(a,b)+A/2}).attr("cx",$).attr("r",A/2).attr("height",A).style("fill",function(a,b){var c;return a.color?a.color:q?(c=a[q],p(c?c:f[q])):p(h)}).on("mousemove",function(a,c){b(a,h,f)}).on("mouseover",function(a,b){c(a,b,f)}).on("mouseout",function(a,b){d(a,b,f)}).on("click",function(a,b){e(a,h,f)}).attr("class",function(a,b){return f.class?"timelineSeries_"+f.class:"timelineSeries_"+h}).attr("id",function(a,b){return f.id&&!a.id?"timelineItem_"+f.id:a.id?a.id:"timelineItem_"+h+"_"+b}),g.selectAll("svg").data(i).enter().append("text").attr("x",_).attr("y",s).text(function(a){return a.label}),m){var l=A+B/2+v.top+(A+B)*t[h];a.append("svg:line").attr("class","row-seperator").attr("x1",0+v.left).attr("x2",k-v.right).attr("y1",l).attr("y2",l).attr("stroke-width",1).attr("stroke",m)}j&&W(a,t,h,j,f),"undefined"!=typeof f.icon&&a.append("image").attr("class","timeline-label").attr("transform","translate(0,"+(v.top+(A+B)*t[h])+")").attr("xlink:href",f.icon).attr("width",v.left).attr("height",A)})});var O=v.top+(A+B)*z,R=v.top,S=E?R:O;if(D&&Q(g,N,S),G&&U(g,N,z),k>h.width){var T=function(){var a=Math.min(0,Math.max(h.width-k,d3.event.translate[0]));X.translate([a,0]),g.attr("transform","translate("+a+",0)"),f(a*L,M)},X=d3.behavior.zoom().x(M).on("zoom",T);a.attr("class","scrollable").call(X)}x&&g.selectAll(".tick text").attr("transform",function(a){return"rotate("+x+")translate("+(this.getBBox().width/2+10)+","+this.getBBox().height/2+")"});var Y=g[0][0].getBoundingClientRect();if(aa(),J&&g.each(function(a,b){a.forEach(function(a){var b=a.times;b.forEach(function(a){ca(M(a.starting_time),K),ca(M(a.ending_time),K)})})}),F){var Z=M(new Date);ca(Z,I)}}var a=["circle","rect"],b=function(){},c=function(){},d=function(){},e=function(){},f=function(){},g=function(a){return a},h=function(){},i=function(){},j="bottom",k=null,l=null,m=null,n=null,o={format:d3.time.format("%I %p"),tickTime:d3.time.hours,tickInterval:1,tickSize:6},p=d3.scale.category20(),q=null,r="rect",s=0,t=0,u=0,v={left:30,right:30,top:30,bottom:30},w=!1,x=!1,y=!1,z=!1,A=20,B=5,C=60,D=!0,E=!1,F=!1,G=!1,H={stroke:"stroke-dasharray",spacing:"4 10"},I={marginTop:25,marginBottom:0,width:1,color:p},J=!1,K={marginTop:25,marginBottom:0,width:1,color:p},L=!1,M=!1,N=!1,O="white",P={},Q=function(a,b,c){L&&T(a,0,0),M&&S(a);a.append("g").attr("class","axis").attr("transform","translate(0,"+c+")").call(b)},R=function(a){var b=s.getFullYear();s.getFullYear()!=u.getFullYear()&&(b=s.getFullYear()+"-"+u.getFullYear()),a.append("text").attr("transform","translate(20, 0)").attr("x",0).attr("y",14).attr("class","calendarYear").text(b)},S=function(a){var b=6,c=v.left-C,d=(k-v.left)/b,e=k-v.right-d+C,f=a.append("g").attr("class","axis").attr("transform","translate(0, 20)");N&&R(f),f.append("text").attr("transform","translate("+c+", 0)").attr("x",0).attr("y",14).attr("class","chevron").text("<").on("click",function(){return h(s,P)}),f.append("text").attr("transform","translate("+e+", 0)").attr("x",0).attr("y",14).attr("class","chevron").text(">").on("click",function(){return i(u,P)})},T=function(a,b,c){a.insert("rect").attr("class","row-green-bar").attr("x",b).attr("width",k).attr("y",c).attr("height",A).attr("fill",O)},U=function(a,b,c){a.append("g").attr("class","axis").attr("transform","translate(0,"+(v.top+(A+B)*c)+")").attr(H.stroke,H.spacing).call(b.tickFormat("").tickSize(-(v.top+(A+B)*(c-1)+3),0,0))},V=function(a,b,c,d,e){var f=(A+B)*a[b]+v.top;c.selectAll("svg").data(d).enter().insert("rect").attr("class","row-green-bar").attr("x",z?0:v.left).attr("width",z?k:k-v.right-v.left).attr("y",f).attr("height",A).attr("fill",n instanceof Function?n(e,b):n)},W=function(a,b,c,d,f){var h=A+B,i=h+h*(b[c]||1);a.append("text").attr("class","timeline-label").attr("transform","translate("+t+","+i+")").text(d?g(f.label):f.id).on("click",function(a,b){e(a,c,f)})};return X.margin=function(a){return arguments.length?(v=a,X):v},X.orient=function(a){return arguments.length?(j=a,X):j},X.itemHeight=function(a){return arguments.length?(A=a,X):A},X.itemMargin=function(a){return arguments.length?(B=a,X):B},X.navMargin=function(a){return arguments.length?(C=a,X):C},X.height=function(a){return arguments.length?(l=a,X):l},X.width=function(a){return arguments.length?(k=a,X):k},X.display=function(b){return arguments.length&&a.indexOf(b)!=-1?(r=b,X):r},X.labelFormat=function(a){return arguments.length?(g=a,X):null},X.tickFormat=function(a){return arguments.length?(o=a,X):o},X.hover=function(a){return arguments.length?(b=a,X):b},X.mouseover=function(a){return arguments.length?(c=a,X):a},X.mouseout=function(a){return arguments.length?(d=a,X):a},X.click=function(a){return arguments.length?(e=a,X):e},X.scroll=function(a){return arguments.length?(f=a,X):f},X.colors=function(a){return arguments.length?(p=a,X):p},X.beginning=function(a){return arguments.length?(s=a,X):s},X.ending=function(a){return arguments.length?(u=a,X):u},X.labelMargin=function(a){return arguments.length?(t=a,X):u},X.rotateTicks=function(a){return x=a,X},X.stack=function(){return w=!w,X},X.relativeTime=function(){return y=!y,X},X.showBorderLine=function(){return J=!J,X},X.showBorderFormat=function(a){return arguments.length?(K=a,X):K},X.showToday=function(){return F=!F,X},X.showTodayFormat=function(a){return arguments.length?(I=a,X):I},X.colorProperty=function(a){return arguments.length?(q=a,X):q},X.rowSeperators=function(a){return arguments.length?(m=a,X):m},X.background=function(a){return arguments.length?(n=a,X):n},X.showTimeAxis=function(){return D=!D,X},X.showAxisTop=function(){return E=!E,X},X.showAxisCalendarYear=function(){return N=!N,X},X.showTimeAxisTick=function(){return G=!G,X},X.fullLengthBackgrounds=function(){return z=!z,X},X.showTimeAxisTickFormat=function(a){return arguments.length?(H=a,X):H},X.showAxisHeaderBackground=function(a){return L=!L,a&&(O=a),X},X.navigate=function(a,b){return h=a,i=b,M=!M,X},X}}();